<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejemplo de Implementaci√≥n - Prueba Ingreso Derivado</title>
    <style>
        /* Estilos para la documentaci√≥n del ejemplo */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #007bff;
        }
        
        .section {
            margin: 30px 0;
            padding: 20px;
            border-left: 4px solid #007bff;
            background-color: #f8f9fa;
        }
        
        .code-block {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        
        .step {
            background-color: #e3f2fd;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid #2196f3;
        }
        
        .warning {
            background-color: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }
        
        .success {
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #28a745;
            margin: 15px 0;
        }
        
        .file-structure {
            background-color: #f1f3f4;
            padding: 20px;
            border-radius: 8px;
            font-family: monospace;
            margin: 15px 0;
        }
        
        h1, h2, h3 {
            color: #2c3e50;
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 5px;
        }
        
        .btn:hover {
            background-color: #0056b3;
        }
        
        .checklist {
            list-style: none;
            padding: 0;
        }
        
        .checklist li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .checklist li:before {
            content: "‚òê ";
            color: #007bff;
            font-weight: bold;
        }
        
        .checklist li.done:before {
            content: "‚úÖ ";
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Ejemplo Completo de Implementaci√≥n</h1>
            <h2>P√°gina Prueba Ingreso Derivado</h2>
            <p>Este ejemplo muestra c√≥mo implementar correctamente la p√°gina de prueba de ingreso derivado en tu sistema.</p>
        </div>

        <div class="section">
            <h2>üìÅ 1. Estructura de Archivos Recomendada</h2>
            <div class="file-structure">
mi-sistema-derivado/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ firebase-init.js          ‚Üê Configuraci√≥n Firebase
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config-prueba.js          ‚Üê Configuraci√≥n del sistema
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.js                   ‚Üê Scripts principales (opcional)
‚îÇ   ‚îî‚îÄ‚îÄ css/
‚îÇ       ‚îî‚îÄ‚îÄ styles.css                ‚Üê Estilos adicionales (opcional)
‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îú‚îÄ‚îÄ testing/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prueba-ingderivado.html   ‚Üê P√°gina principal
‚îÇ   ‚îú‚îÄ‚îÄ index.html                    ‚Üê P√°gina de login
‚îÇ   ‚îî‚îÄ‚îÄ ingreso-derivado.html         ‚Üê P√°gina de procesamiento (GET)
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ README.md                     ‚Üê Documentaci√≥n
‚îî‚îÄ‚îÄ firebase.json                     ‚Üê Configuraci√≥n Firebase (opcional)
            </div>
        </div>

        <div class="section">
            <h2>‚öôÔ∏è 2. Configuraci√≥n de Firebase</h2>
            
            <div class="step">
                <h3>Paso 1: Crear firebase-init.js</h3>
                <p>Archivo: <code>assets/js/firebase-init.js</code></p>
            </div>
            
            <div class="code-block">
// Configuraci√≥n Firebase - REEMPLAZAR CON TUS DATOS
const firebaseConfig = {
    apiKey: "AIzaSyC-ejemplo-api-key",
    authDomain: "mi-sistema.firebaseapp.com",
    projectId: "mi-sistema-id",
    storageBucket: "mi-sistema.appspot.com",
    messagingSenderId: "123456789",
    appId: "1:123456789:web:abcdef123456"
};

// Inicializar Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();
const storage = firebase.storage();

// Configuraci√≥n del sistema
window.SISTEMA_NOMBRE = "MI_SISTEMA_DERIVADO";
window.LOGIN_URL = "index.html";
window.INGRESO_DERIVADO_URL = "ingreso-derivado.html";      // P√°gina de procesamiento
window.INGRESO_DERIVADO_ENDPOINT = "ingreso-derivado";      // Endpoint POST
window.SESSION_STORAGE_KEY = "ls_session";
window.SESSION_TIMEOUT_HOURS = 8;
window.TIMESTAMP_TIMEOUT_MINUTES = 15;

console.log('‚úÖ Firebase inicializado para:', window.SISTEMA_NOMBRE);
            </div>
        </div>

        <div class="section">
            <h2>üîß 3. Configuraci√≥n del Sistema</h2>
            
            <div class="step">
                <h3>Paso 2: Crear config-prueba.js</h3>
                <p>Archivo: <code>assets/js/config-prueba.js</code></p>
            </div>
            
            <div class="code-block">
// Configuraci√≥n espec√≠fica para prueba-ingderivado
window.PRUEBA_INGDERIVADO_CONFIG = {
    sistema: {
        nombre: "Mi Sistema Derivado",
        version: "1.0.0",
        descripcion: "Sistema derivado de Ledroit Master"
    },
    
    urls: {
        login: "index.html",
        ingresoDerivado: "ingreso-derivado.html",           // P√°gina de procesamiento
        ingresoDerivadoEndpoint: "ingreso-derivado",        // Endpoint POST
        dashboard: "dashboard.html",
        ayuda: "ayuda.html"
    },
    
    sesion: {
        storageKey: "ls_session",
        timeoutHoras: 8,
        timestampTimeoutMinutos: 15,
        validarEstructura: true
    },
    
    ui: {
        titulo: "Prueba de Ingreso Derivado - Mi Sistema",
        mostrarLogo: true,
        tema: "claro",
        colorPrimario: "#007bff",
        colorSecundario: "#6c757d"
    },
    
    funcionalidades: {
        modoActivo: true,
        modoPasivo: true,
        logs: true,
        exportarLogs: false,
        validacionAvanzada: true,
        debugMode: false  // Cambiar a true para desarrollo
    }
};

// Funci√≥n para obtener configuraci√≥n
window.getConfig = function(seccion) {
    return seccion ? 
        window.PRUEBA_INGDERIVADO_CONFIG[seccion] : 
        window.PRUEBA_INGDERIVADO_CONFIG;
};

console.log('‚úÖ Configuraci√≥n cargada:', window.getConfig('sistema').nombre);
            </div>
        </div>

        <div class="section">
            <h2>üìÑ 4. P√°gina Principal</h2>
            
            <div class="step">
                <h3>Paso 3: Crear prueba-ingderivado.html</h3>
                <p>Archivo: <code>pages/testing/prueba-ingderivado.html</code></p>
            </div>
            
            <div class="warning">
                <strong>‚ö†Ô∏è Importante:</strong> Copiar el contenido completo de <code>prueba-ingderivado.html</code> 
                desde la documentaci√≥n y adaptar las rutas de los scripts seg√∫n tu estructura de carpetas.
            </div>
            
            <div class="code-block">
&lt;!DOCTYPE html&gt;
&lt;html lang="es"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Prueba de Ingreso Derivado - Mi Sistema&lt;/title&gt;
    &lt;!-- Resto del head del archivo original --&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;!-- Contenido completo del archivo original --&gt;
    
    &lt;!-- Scripts de Firebase (al final del body) --&gt;
    &lt;script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"&gt;&lt;/script&gt;
    &lt;script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"&gt;&lt;/script&gt;
    &lt;script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"&gt;&lt;/script&gt;
    &lt;script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"&gt;&lt;/script&gt;
    
    &lt;!-- Scripts de configuraci√≥n - ADAPTAR RUTAS --&gt;
    &lt;script src="../../assets/js/config-prueba.js"&gt;&lt;/script&gt;
    &lt;script src="../../assets/js/firebase-init.js"&gt;&lt;/script&gt;
    
    &lt;!-- Script principal de la p√°gina (ya incluido en el archivo) --&gt;
&lt;/body&gt;
&lt;/html&gt;
            </div>
        </div>

        <div class="section">
            <h2>üîê 5. Configuraci√≥n de Sesi√≥n</h2>
            
            <div class="step">
                <h3>Paso 4: Preparar estructura de sesi√≥n</h3>
                <p>Tu sistema debe guardar la sesi√≥n en sessionStorage con esta estructura:</p>
            </div>
            
            <div class="code-block">
// Ejemplo de sesi√≥n v√°lida
const sesionEjemplo = {
    "initials": "AB",
    "user": "usuario@ejemplo.com",
    "companies": [
        {
            "id": "123",
            "name": "Empresa Ejemplo",
            "active": true
        }
    ],
    "timestamp": Date.now(),
    "ledroitMasterResponse": {
        "success": true,
        "data": {
            "message": "Sesi√≥n iniciada correctamente"
        }
    }
};

// Guardar en sessionStorage
sessionStorage.setItem('ls_session', JSON.stringify(sesionEjemplo));
            </div>
            
            <div class="step">
                <h3>Script para crear sesi√≥n de prueba:</h3>
            </div>
            
            <div class="code-block">
// Ejecutar en consola del navegador para testing
function crearSesionPrueba() {
    const sesion = {
        initials: "TP",
        user: "test@prueba.com",
        companies: [
            { id: "test-001", name: "Empresa Test", active: true }
        ],
        timestamp: Date.now(),
        ledroitMasterResponse: { success: true, data: {} }
    };
    
    sessionStorage.setItem('ls_session', JSON.stringify(sesion));
    console.log('‚úÖ Sesi√≥n de prueba creada');
    location.reload();
}

crearSesionPrueba();
            </div>
        </div>

        <div class="section">
            <h2>üß™ 6. Testing y Validaci√≥n</h2>
            
            <div class="step">
                <h3>Checklist de Testing:</h3>
            </div>
            
            <ul class="checklist">
                <li>Abrir p√°gina sin errores en consola</li>
                <li>Firebase se inicializa correctamente</li>
                <li>Configuraci√≥n se carga sin errores</li>
                <li>Sesi√≥n se detecta y valida</li>
                <li>Modo ACTIVO genera JSON correctamente</li>
                <li>Modo PASIVO valida JSON de entrada</li>
                <li>Sistema de logs funciona</li>
                <li>Notificaciones toast aparecen</li>
                <li>Navegaci√≥n entre pesta√±as funciona</li>
                <li>Responsive design se ve bien</li>
            </ul>
            
            <div class="step">
                <h3>Scripts de validaci√≥n:</h3>
            </div>
            
            <div class="code-block">
// Ejecutar en consola para validar implementaci√≥n
console.log('üîç VALIDACI√ìN DE IMPLEMENTACI√ìN');
console.log('================================');

// 1. Verificar Firebase
console.log('Firebase apps:', firebase.apps.length > 0 ? '‚úÖ' : '‚ùå');

// 2. Verificar configuraci√≥n
console.log('Config cargada:', 
    typeof window.getConfig === 'function' ? '‚úÖ' : '‚ùå');

// 3. Verificar sesi√≥n
const session = sessionStorage.getItem('ls_session');
console.log('Sesi√≥n existe:', session ? '‚úÖ' : '‚ùå');

// 4. Verificar estructura de sesi√≥n
if (session) {
    try {
        const data = JSON.parse(session);
        const required = ['initials', 'user', 'companies', 'timestamp'];
        const valid = required.every(field => data[field]);
        console.log('Sesi√≥n v√°lida:', valid ? '‚úÖ' : '‚ùå');
    } catch (e) {
        console.log('Sesi√≥n v√°lida: ‚ùå (JSON inv√°lido)');
    }
}

// 5. Verificar funciones principales
console.log('Funci√≥n cargarSesion:', 
    typeof cargarSesion === 'function' ? '‚úÖ' : '‚ùå');
console.log('Funci√≥n switchTab:', 
    typeof switchTab === 'function' ? '‚úÖ' : '‚ùå');

console.log('================================');
            </div>
        </div>

        <div class="section">
            <h2>üöÄ 7. Despliegue</h2>
            
            <div class="step">
                <h3>Preparaci√≥n para producci√≥n:</h3>
            </div>
            
            <div class="code-block">
// En config-prueba.js, cambiar para producci√≥n:
window.PRUEBA_INGDERIVADO_CONFIG.funcionalidades.debugMode = false;
window.PRUEBA_INGDERIVADO_CONFIG.avanzado.logLevel = "error";
window.PRUEBA_INGDERIVADO_CONFIG.funcionalidades.logs = false;
            </div>
            
            <div class="warning">
                <strong>‚ö†Ô∏è Seguridad:</strong>
                <ul>
                    <li>NO incluir configuraciones reales de Firebase en repositorios p√∫blicos</li>
                    <li>Usar variables de entorno en producci√≥n</li>
                    <li>Configurar reglas de seguridad en Firebase</li>
                    <li>Validar datos de entrada siempre</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>üìû 8. Soporte y Troubleshooting</h2>
            
            <div class="step">
                <h3>Problemas comunes y soluciones:</h3>
            </div>
            
            <div class="code-block">
// Error: "Firebase no inicializado"
// Soluci√≥n: Verificar configuraci√≥n y orden de scripts

// Error: "Sesi√≥n no encontrada"  
// Soluci√≥n: Crear sesi√≥n de prueba con el script proporcionado

// Error: "Timestamp expirado"
// Soluci√≥n: Actualizar timestamp en la sesi√≥n

// Error: "Empresas no activas"
// Soluci√≥n: Verificar array de companies en la sesi√≥n
            </div>
            
            <div class="success">
                <strong>‚úÖ ¬°Implementaci√≥n Completada!</strong><br>
                Tu p√°gina de prueba de ingreso derivado est√° lista para usar. 
                Recuerda mantener las configuraciones actualizadas y realizar testing regular.
            </div>
        </div>

        <div class="section">
            <h2>üìö Recursos Adicionales</h2>
            <p>
                <a href="README.md" class="btn">üìñ Documentaci√≥n Completa</a>
                <a href="GUIA-PASO-A-PASO.md" class="btn">üöÄ Gu√≠a Paso a Paso</a>
                <a href="firebase-init-template.js" class="btn">‚öôÔ∏è Template Firebase</a>
                <a href="config-template.js" class="btn">üîß Template Configuraci√≥n</a>
            </p>
        </div>
    </div>

    <script>
        // Script para hacer interactivo el checklist
        document.addEventListener('DOMContentLoaded', function() {
            const checklistItems = document.querySelectorAll('.checklist li');
            
            checklistItems.forEach(item => {
                item.addEventListener('click', function() {
                    this.classList.toggle('done');
                });
            });
            
            // Mensaje de bienvenida
            console.log('üìã Ejemplo de Implementaci√≥n - Prueba Ingreso Derivado');
            console.log('Haz clic en los elementos del checklist para marcarlos como completados');
        });
    </script>
</body>
</html>